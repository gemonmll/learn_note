好的，这是您要求的Markdown格式版本。

# 四旋翼六自由度非线性动力学模型的系统性推导

---

### **摘要**

本报告旨在提供一个基于第一性原理的、详尽的四旋翼无人机（UAV）六自由度（6-DOF）非线性动力学模型推导过程。从建立运动学参考框架入手，详细阐述了惯性坐标系与机体坐标系之间的关系，并推导了基于欧拉角和四元数的姿态表示法及其运动学方程。报告深入分析了四旋翼的驱动力学，包括单个旋翼的空气动力学特性以及如何通过差分推力产生控制力和力矩。在此基础上，应用牛顿-欧拉方法系统地推导了描述飞行器平动和转动的非线性动力学方程。最终，将所有方程整合成一个完整的十二维状态空间模型。此外，报告还审慎地探讨了模型建立过程中所依赖的关键简化假设及其对模型保真度的影响，并简要介绍了模型在悬停平衡点附近的线性化方法。本文档旨在为从事无人机研究、控制系统设计及高保真仿真的工程师与科研人员提供一个严谨、全面的数学物理基础。

---

### **符号与参数列表**

为确保本文档的严谨性与清晰度，以下表格定义了推导过程中使用的关键符号、参数及其物理意义和单位。建立统一的符号体系是进行复杂数学推导的基石，能够有效避免因坐标系混淆或变量定义不清而导致的错误。

| 符号                        | 描述                                         | 单位                          |
| :-------------------------- | :------------------------------------------- | :---------------------------- |
| $E$                         | 惯性坐标系（地面坐标系）                     | N/A                           |
| $B$                         | 机体坐标系                                   | N/A                           |
| $\phi, \theta, \psi$        | 姿态欧拉角（滚转角、俯仰角、偏航角）         | rad                           |
| $p, q, r$                   | 机体坐标系下的角速度（滚转、俯仰、偏航速率） | rad/s                         |
| $x, y, z$                   | 惯性坐标系下的位置坐标                       | m                             |
| $\dot{x}, \dot{y}, \dot{z}$ | 惯性坐标系下的速度分量                       | m/s                           |
| $u, v, w$                   | 机体坐标系下的速度分量                       | m/s                           |
| $m$                         | 四旋翼总质量                                 | kg                            |
| $g$                         | 重力加速度                                   | m/s$^2$                       |
| $L$                         | 质心到旋翼旋转轴的距离（机臂长度）           | m                             |
| $I$                         | 惯性张量                                     | kg$\cdot$m$^2$                |
| $I_{xx}, I_{yy}, I_{zz}$    | 沿机体坐标系主轴的转动惯量                   | kg$\cdot$m$^2$                |
| $k_t$                       | 旋翼推力系数                                 | N$\cdot$s$^2$/rad$^2$         |
| $k_d$                       | 旋翼阻力（反扭矩）系数                       | N$\cdot$m$\cdot$s$^2$/rad$^2$ |
| $\omega_i$                  | 第 $i$ 个旋翼的角速度 ($i=1,2,3,4$)          | rad/s                         |
| $F_i, \tau_i$               | 第 $i$ 个旋翼产生的推力和反扭矩              | N, N$\cdot$m                  |
| $U_1$                       | 总推力控制输入                               | N                             |
| $U_2, U_3, U_4$             | 滚转、俯仰、偏航力矩控制输入                 | N$\cdot$m                     |
| $R$                         | 从机体坐标系到惯性坐标系的旋转矩阵           | N/A                           |

---

## 1. 基础运动学：参考框架与姿态表示

在推导任何运动对象的动力学模型之前，必须首先建立一个清晰的运动学框架。这个框架用于描述对象的位置、速度、姿态和角速度。对于四旋翼飞行器而言，这涉及到定义坐标系、选择姿态表示方法，并建立不同物理量之间的数学关系。

### 1.1. 惯性坐标系与机体坐标系的定义

为了精确描述四旋翼在空间中的运动，需要建立两个核心的坐标系 [1, 2]。

*   **惯性坐标系 (Inertial Frame, $E$)**: 也称为地面坐标系或世界坐标系。这是一个固定不动的参考系，用于描述四旋翼的绝对位置和速度。为了简化模型，通常做出如下假设：将地球表面视为一个平面，并忽略地球的自转和曲率，从而将地面坐标系视为一个理想的惯性系 [2]。该坐标系的原点通常选择在地面上的某个固定点，其坐标轴可以遵循东北天（ENU）或北东地（NED）约定。

*   **机体坐标系 (Body Frame, $B$)**: 这是一个牢固地附着在四旋翼刚体上的坐标系，随飞行器一同运动 [1]。其原点通常与四旋翼的质心（Center of Mass, CoM）重合，这是一个关键的简化假设，极大地简化了力矩的计算 [2]。坐标轴通常与飞行器的几何结构对齐：$x_B$ 轴指向飞行器前方，$y_B$ 轴指向左侧，$z_B$ 轴垂直向上。在机体坐标系中描述物理量具有一个显著优势：由于坐标系与刚体固连，四旋翼的惯性张量在该坐标系下是一个常数矩阵，这为后续的旋转动力学分析提供了极大的便利 [1]。

### 1.2. 通过欧拉角描述姿态（滚转、俯仰、偏航）

飞行器的姿态定义了机体坐标系 $B$ 相对于惯性坐标系 $E$ 的方位。在航空航天领域，最常用的姿态描述方法是欧拉角，即滚转角（Roll, $\phi$）、俯仰角（Pitch, $\theta$）和偏航角（Yaw, $\psi$） [3]。这三个角度表示了将惯性坐标系 $E$ 旋转到与机体坐标系 $B$ 对齐所需的一组有序旋转。最常用的旋转顺序是 Z-Y'-X"（偏航-俯仰-滚转）[4]：

1.  **偏航 ($\psi$)**: 首先，围绕惯性系的 $z_E$ 轴旋转 $\psi$ 角。
2.  **俯仰 ($\theta$)**: 接着，围绕第一次旋转后得到的新坐标系的 $y'$ 轴旋转 $\theta$ 角。
3.  **滚转 ($\phi$)**: 最后，围绕第二次旋转后得到的新坐标系的 $x''$ 轴旋转 $\phi$ 角。

经过这三次旋转，惯性坐标系 $E$ 就完全与机体坐标系 $B$ 对齐。

### 1.3. 旋转矩阵：坐标系间的矢量变换

旋转矩阵 $R$ 是连接两个坐标系的核心数学工具，它能够将一个在机体坐标系中表示的矢量 $v_B$ 转换为其在惯性坐标系中的表示 $v_E$，其关系为 $v_E = R v_B$。这个矩阵是整个动力学模型中最为关键的数学构造之一，因为它将飞行器在自身坐标系下产生的力（如推力）与在惯性坐标系中产生的加速度联系起来。没有旋转矩阵，平动动力学和转动动力学将无法耦合。

根据 Z-Y'-X" 的旋转顺序，总的旋转矩阵 $R$ 是三次基本旋转矩阵的乘积：

$R = R_z(\psi) R_y(\theta) R_x(\phi)$

其中，
$R_z(\psi) = \begin{pmatrix} \cos\psi & -\sin\psi & 0 \\ \sin\psi & \cos\psi & 0 \\ 0 & 0 & 1 \end{pmatrix}$
$R_y(\theta) = \begin{pmatrix} \cos\theta & 0 & \sin\theta \\ 0 & 1 & 0 \\ -\sin\theta & 0 & \cos\theta \end{pmatrix}$
$R_x(\phi) = \begin{pmatrix} 1 & 0 & 0 \\ 0 & \cos\phi & -\sin\phi \\ 0 & \sin\phi & \cos\phi \end{pmatrix}$

将这三个矩阵相乘，得到从机体坐标系到惯性坐标系的总旋转矩阵 $R_{B \to E}$：

$$
R = \begin{pmatrix} \cos\psi\cos\theta & \cos\psi\sin\theta\sin\phi - \sin\psi\cos\phi & \cos\psi\sin\theta\cos\phi + \sin\psi\sin\phi \\ \sin\psi\cos\theta & \sin\psi\sin\theta\sin\phi + \cos\psi\cos\phi & \sin\psi\sin\theta\cos\phi - \cos\psi\sin\phi \\ -\sin\theta & \cos\theta\sin\phi & \cos\theta\cos\phi \end{pmatrix}
$$

### 1.4. 运动学方程：关联机体角速度与欧拉角变化率

机载惯性测量单元（IMU）中的陀螺仪直接测量的是机体坐标系下的角速度矢量 $\omega_B = [p, q, r]^T$。然而，在状态描述和控制中，我们通常关心的是欧拉角的变化率 $[\dot{\phi}, \dot{\theta}, \dot{\psi}]^T$。这两者之间并非简单的相等关系，而是通过一个与当前姿态相关的变换矩阵 $W$ 联系起来。

角速度矢量 $[\dot{\phi}, \dot{\theta}, \dot{\psi}]^T$ 可以表示为三次独立旋转速率的叠加。通过将机体角速度 $p, q, r$ 投影到发生旋转的各个轴上，可以推导出它们之间的运动学关系：

$$
\begin{pmatrix} \dot{\phi} \\ \dot{\theta} \\ \dot{\psi} \end{pmatrix} = \begin{pmatrix} 1 & \sin\phi\tan\theta & \cos\phi\tan\theta \\ 0 & \cos\phi & -\sin\phi \\ 0 & \sin\phi\sec\theta & \cos\phi\sec\theta \end{pmatrix} \begin{pmatrix} p \\ q \\ r \end{pmatrix}
$$

这个方程是运动学模型的重要组成部分，它将可测量的物理量（机体角速度）与状态变量（欧拉角）的导数联系起来。

### 1.5. 欧拉角的致命局限：万向节锁

尽管欧拉角直观易懂，但它存在一个固有的、严重的问题，即**万向节锁（Gimbal Lock）** [4]。从上述运动学方程中可以观察到，当俯仰角 $\theta$ 趋近于 $\pm 90^\circ$ ($\pm \pi/2$ rad) 时，$\tan\theta$ 和 $\sec\theta$ 项会趋于无穷大。

这不仅仅是一个数学上的奇点，它对应着一个物理上的灾难性状态。当 $\theta = \pm 90^\circ$ 时，滚转轴和偏航轴会发生重合。此时，系统失去了一个旋转自由度。飞行器无法再独立地控制滚转和偏航，任何试图改变其中一个的控制输入都会导致两者不受控地混合运动，最终导致飞行器失控。因此，任何为高机动性、大姿态角飞行的无人机设计的模型和控制器，都必须避免或解决万向节锁问题。

### 1.6. 稳健的替代方案：使用四元数表示姿态

为了从根本上解决万向节锁问题，可以采用四元数（Quaternions）来表示姿态 [4]。单位四元数是一个四维的数学对象，$q = [q_0, q_1, q_2, q_3]^T$，其中 $q_0$ 是标量部分，$[q_1, q_2, q_3]^T$ 是矢量部分，且满足约束 $q_0^2 + q_1^2 + q_2^2 + q_3^2 = 1$。

四元数通过一个四维向量表示三维旋转，避免了任何奇点，因此不存在万向节锁问题 [5, 6]。它在计算上也比旋转矩阵更高效。机体角速度 $[p, q, r]^T$ 与四元数变化率 $\dot{q}$ 之间的运动学关系是线性的，且不含任何奇点：

$$
\begin{pmatrix} \dot{q}_0 \\ \dot{q}_1 \\ \dot{q}_2 \\ \dot{q}_3 \end{pmatrix} = \frac{1}{2} \begin{pmatrix} 0 & -p & -q & -r \\ p & 0 & r & -q \\ q & -r & 0 & p \\ r & q & -p & 0 \end{pmatrix} \begin{pmatrix} q_0 \\ q_1 \\ q_2 \\ q_3 \end{pmatrix}
$$

对于需要进行特技飞行或大角度机动的应用，使用四元数进行建模和控制是更为稳健和可靠的选择。

---

## 2. 驱动力学：力与力矩的分析

四旋翼的全部运动控制都源于对其四个旋翼转速的精确调节 [7]。改变旋翼转速会改变其产生的推力和反扭矩，从而在机体上产生合力和合力矩，驱动飞行器进行平动和转动。

### 2.1. 单个旋翼的空气动力学：推力与反扭矩

当旋翼旋转时，其翼型剖面会与空气相互作用，产生向上的升力，即**推力（Thrust）**。根据牛顿第三定律，电机驱动旋翼旋转的同时，空气也会给旋翼一个反向的阻力力矩，这个力矩会通过电机传递给机身，称为**反扭矩（Reactive Torque）** [7]。

在控制模型中，通常对复杂的空气动力学进行简化。一个广泛采用且行之有效的假设是：旋翼产生的推力 $F_i$ 和反扭矩 $\tau_i$ 均与其角速度 $\omega_i$ 的平方成正比 [2, 8]。

*   推力：$F_i = k_t \omega_i^2$
*   反扭矩：$\tau_i = k_d \omega_i^2$

其中，$k_t$ 是推力系数，$k_d$ 是阻力系数。这两个系数与空气密度、桨叶的几何形状（如半径、弦长、螺距）等因素有关。尽管真实的气动效应（如诱导速度、地面效应、下洗流干扰等）要复杂得多 [9]，但对于大多数控制应用而言，这个二次模型已经足够精确。

### 2.2. 四个主要控制输入的推导

四旋翼的六自由度运动是由四个独立的控制输入（四个电机转速）驱动的，这是一个典型的**欠驱动系统** [10, 11]。这意味着我们无法独立控制所有的六个自由度。具体来说，我们可以直接控制高度和三个姿态角，但无法直接控制水平位置。水平运动必须通过改变姿态，使总推力产生水平分量来实现 [12, 13]。

为了便于控制器设计，通常将四个电机转速组合成四个“虚拟”的控制输入：总推力 $U_1$、滚转力矩 $U_2$、俯仰力矩 $U_3$ 和偏航力矩 $U_4$ [14]。假设四旋翼为标准的“X”型结构，电机1为右前方，电机2为左前方，电机3为左后方，电机4为右后方。电机1和3顺时针（CW）旋转，电机2和4逆时针（CCW）旋转以抵消反扭矩。

1.  **总推力 ($U_1$)**: 用于控制飞行器的垂直运动（上升、下降、悬停）。它等于四个旋翼推力之和，始终沿机体 $z_B$ 轴正方向。
    $U_1 = F_1 + F_2 + F_3 + F_4 = k_t (\omega_1^2 + \omega_2^2 + \omega_3^2 + \omega_4^2)$

2.  **滚转力矩 ($U_2$)**: 用于控制绕机体 $x_B$ 轴的滚转运动。通过在左右两侧旋翼间产生推力差来实现。增加右侧（1, 4）推力并减小左侧（2, 3）推力，会产生一个使飞行器向左滚转的正力矩。
    $U_2 = L(F_2 + F_3 - F_1 - F_4) = L k_t (\omega_2^2 + \omega_3^2 - \omega_1^2 - \omega_4^2)$

3.  **俯仰力矩 ($U_3$)**: 用于控制绕机体 $y_B$ 轴的俯仰运动。通过在前后两侧旋翼间产生推力差来实现。增加前方（1, 2）推力并减小后方（3, 4）推力，会产生一个使飞行器抬头的正力矩。
    $U_3 = L(F_1 + F_2 - F_3 - F_4) = L k_t (\omega_1^2 + \omega_2^2 - \omega_3^2 - \omega_4^2)$

4.  **偏航力矩 ($U_4$)**: 用于控制绕机体 $z_B$ 轴的偏航运动。这个控制最为巧妙，它利用了反扭矩的不平衡。增加顺时针旋转的桨（1, 3）的转速，同时减小逆时针旋转的桨（2, 4）的转速，会导致顺时针方向的反扭矩大于逆时针方向的反扭矩，从而产生一个使机体逆时针（正向偏航）旋转的净力矩 [7, 11]。
    $U_4 = \tau_2 + \tau_4 - \tau_1 - \tau_3 = k_d (\omega_2^2 + \omega_4^2 - \omega_1^2 - \omega_3^2)$

### 2.3. 控制分配矩阵

上述关系可以将虚拟控制输入向量 $[U_1, U_2, U_3, U_4]^T$ 与各旋翼角速度平方的向量 $[\omega_1^2, \omega_2^2, \omega_3^2, \omega_4^2]^T$ 通过一个**控制分配矩阵** $A$ 联系起来：

$$
\begin{pmatrix} U_1 \\ U_2 \\ U_3 \\ U_4 \end{pmatrix} = \begin{pmatrix} k_t & k_t & k_t & k_t \\ -k_t L & k_t L & k_t L & -k_t L \\ k_t L & k_t L & -k_t L & -k_t L \\ -k_d & k_d & -k_d & k_d \end{pmatrix} \begin{pmatrix} \omega_1^2 \\ \omega_2^2 \\ \omega_3^2 \\ \omega_4^2 \end{pmatrix}
$$

在实际控制中，控制器会计算出期望的 $U_1, U_2, U_3, U_4$，然后通过求解该矩阵的逆 $A^{-1}$，得到每个电机需要达到的目标角速度（的平方），这个过程被称为**控制分配** [7]。

为了更直观地理解控制原理，下表总结了基本飞行机动与旋翼转速调节之间的关系。

**表1：四旋翼飞行机动与旋翼转速调节**

| 机动         | $\omega_1$ (右前) | $\omega_2$ (左前) | $\omega_3$ (左后) | $\omega_4$ (右后) | 主要控制输入变化          |
| :----------- | :---------------- | :---------------- | :---------------- | :---------------- | :------------------------ |
| **悬停**     | 基准              | 基准              | 基准              | 基准              | $U_1 = mg, U_2=U_3=U_4=0$ |
| **上升**     | $\uparrow$        | $\uparrow$        | $\uparrow$        | $\uparrow$        | $U_1 \uparrow$            |
| **下降**     | $\downarrow$      | $\downarrow$      | $\downarrow$      | $\downarrow$      | $U_1 \downarrow$          |
| **向左滚转** | $\downarrow$      | $\uparrow$        | $\uparrow$        | $\downarrow$      | $U_2 \uparrow$            |
| **向前俯仰** | $\downarrow$      | $\downarrow$      | $\uparrow$        | $\uparrow$        | $U_3 \downarrow$          |
| **向右偏航** | $\uparrow$        | $\downarrow$      | $\uparrow$        | $\downarrow$      | $U_4 \downarrow$          |

---

## 3. 六自由度非线性动力学方程的牛顿-欧拉推导

有了运动学框架和驱动力学模型，现在可以应用经典力学的基本定律——牛顿第二定律和牛顿-欧拉方程——来推导描述四旋翼运动的动力学方程 [15]。

### 3.1. 平动动力学：牛顿第二定律的应用

牛顿第二定律指出，物体的加速度与其所受合外力成正比，关系为 $\sum F = m a$ [16, 17, 18]。这个定律必须在**惯性坐标系**中应用，因为加速度是相对于惯性系的。

1.  **识别外力**: 作用在四旋翼质心上的外力有两个：
    *   **重力 ($F_g$)**: 方向始终沿惯性系 $z_E$ 轴负方向，大小为 $mg$。在惯性系中表示为 $F_{g,E} = [0, 0, -mg]^T$。
    *   **总推力 ($F_{thrust}$)**: 由四个旋翼产生，方向始终沿机体 $z_B$ 轴正方向，大小为 $U_1$。在机体坐标系中表示为 $F_{thrust,B} = [0, 0, U_1]^T$。

2.  **统一坐标系**: 为了将两个力相加，必须将它们表示在同一个坐标系下。我们将机体坐标系下的推力 $F_{thrust,B}$ 通过旋转矩阵 $R$ 转换到惯性坐标系：
    $F_{thrust,E} = R \cdot F_{thrust,B} = R \cdot [0, 0, U_1]^T$

3.  **建立方程**: 将惯性系下的合力与质量和加速度联系起来，其中加速度 $a_E = [\ddot{x}, \ddot{y}, \ddot{z}]^T$。
    $m \begin{pmatrix} \ddot{x} \\ \ddot{y} \\ \ddot{z} \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \\ -mg \end{pmatrix} + R \begin{pmatrix} 0 \\ 0 \\ U_1 \end{pmatrix}$

    将旋转矩阵 $R$ 的第三列表达式代入，得到三个标量形式的平动动力学方程：
    $$
    \begin{cases}
    m\ddot{x} = (\cos\psi\sin\theta\cos\phi + \sin\psi\sin\phi) U_1 \\
    m\ddot{y} = (\sin\psi\sin\theta\cos\phi - \cos\psi\sin\phi) U_1 \\
    m\ddot{z} = (\cos\theta\cos\phi) U_1 - mg
    \end{cases}
    $$
    这些方程清晰地展示了平动与姿态之间的强耦合关系。例如，要产生 $x$ 方向的加速度，必须通过改变俯仰角 $\theta$ 和滚转角 $\phi$ 来实现。

### 3.2. 转动动力学：刚体牛顿-欧拉方程的应用

对于刚体的转动，使用牛顿-欧拉方程更为方便。该方程在**机体坐标系**中表述最为简洁，因为它避免了惯性张量随时间变化的问题。方程形式为：
$\sum \tau_B = I \dot{\omega}_B + \omega_B \times (I \omega_B)$

其中，$\sum \tau_B$ 是作用在质心上的合外力矩，$\omega_B = [p, q, r]^T$ 是机体角速度，$\dot{\omega}_B = [\dot{p}, \dot{q}, \dot{r}]^T$ 是机体角加速度，$I$ 是惯性张量。

1.  **定义惯性张量**: 为了简化模型，通常假设四旋翼是几何对称的刚体，这意味着其惯性积（非对角线元素）为零 [11, 19]。因此，惯性张量是一个对角矩阵：
    $I = \begin{pmatrix} I_{xx} & 0 & 0 \\ 0 & I_{yy} & 0 \\ 0 & 0 & I_{zz} \end{pmatrix}$

2.  **识别外力矩**: 作用在机体上的外力矩就是我们在第2节中推导出的控制力矩向量 $\tau_B = [U_2, U_3, U_4]^T$。这里忽略了空气阻力力矩和旋翼的陀螺效应等次要影响。

3.  **展开方程**: 将对角形式的惯性张量和控制力矩代入牛顿-欧拉方程：
    $\begin{pmatrix} U_2 \\ U_3 \\ U_4 \end{pmatrix} = \begin{pmatrix} I_{xx} & 0 & 0 \\ 0 & I_{yy} & 0 \\ 0 & 0 & I_{zz} \end{pmatrix} \begin{pmatrix} \dot{p} \\ \dot{q} \\ \dot{r} \end{pmatrix} + \begin{pmatrix} p \\ q \\ r \end{pmatrix} \times \left( \begin{pmatrix} I_{xx} & 0 & 0 \\ 0 & I_{yy} & 0 \\ 0 & 0 & I_{zz} \end{pmatrix} \begin{pmatrix} p \\ q \\ r \end{pmatrix} \right)$

    计算叉乘项（即陀螺力矩项），它描述了不同轴向旋转之间的耦合效应 [12]：
    $\omega_B \times (I \omega_B) = \begin{pmatrix} p \\ q \\ r \end{pmatrix} \times \begin{pmatrix} I_{xx}p \\ I_{yy}q \\ I_{zz}r \end{pmatrix} = \begin{pmatrix} (I_{zz} - I_{yy})qr \\ (I_{xx} - I_{zz})pr \\ (I_{yy} - I_{xx})pq \end{pmatrix}$

    整理后，得到三个标量形式的转动动力学方程 [2, 14]：
    $$
    \begin{cases}
    I_{xx}\dot{p} = (I_{yy} - I_{zz})qr + U_2 \\
    I_{yy}\dot{q} = (I_{zz} - I_{xx})pr + U_3 \\
    I_{zz}\dot{r} = (I_{xx} - I_{yy})pq + U_4
    \end{cases}
    $$
    这些方程揭示了旋转运动的非线性和耦合特性。例如，滚转角加速度 $\dot{p}$ 不仅取决于滚转控制力矩 $U_2$，还受到俯仰和偏航角速度 $q$ 和 $r$ 的影响。

---

## 4. 完整的状态空间模型

通过综合前面的运动学和动力学推导，我们可以构建一个完整的数学模型，以状态空间方程的形式描述四旋翼的全部运动。

### 4.1. 定义十二维状态向量

为了完全描述四旋翼在任意时刻的运动状态，需要12个状态变量。这些变量共同构成状态向量 $X$：

$X = [x, y, z, \phi, \theta, \psi, \dot{x}, \dot{y}, \dot{z}, p, q, r]^T$

这个向量包含了飞行器的三维位置、三维姿态、三维线速度和三维角速度，完整地定义了其在六个自由度上的状态。

### 4.2. 整合为一阶非线性微分方程组

动力学模型的最终形式是一个由12个一阶非线性微分方程组成的方程组，其标准形式为 $\dot{X} = f(X, U)$。其中 $U = [U_1, U_2, U_3, U_4]^T$ 是控制输入向量。

将第1节和第3节的方程整合在一起，得到完整的状态空间模型：

**运动学方程**:
*   位置变化率等于速度：
    $\dot{x} = \dot{x}$
    $\dot{y} = \dot{y}$
    $\dot{z} = \dot{z}$
    *(注：这里为了构成12维一阶系统，将速度视为状态变量)*

*   欧拉角变化率（姿态运动学）：
    $\dot{\phi} = p + q(\sin\phi\tan\theta) + r(\cos\phi\tan\theta)$
    $\dot{\theta} = q\cos\phi - r\sin\phi$
    $\dot{\psi} = q(\sin\phi\sec\theta) + r(\cos\phi\sec\theta)$

**动力学方程**:
*   线加速度（平动动力学）：
    $\ddot{x} = \frac{1}{m}(\cos\psi\sin\theta\cos\phi + \sin\psi\sin\phi) U_1$
    $\ddot{y} = \frac{1}{m}(\sin\psi\sin\theta\cos\phi - \cos\psi\sin\phi) U_1$
    $\ddot{z} = \frac{1}{m}(\cos\theta\cos\phi) U_1 - g$

*   角加速度（转动动力学）：
    $\dot{p} = \frac{I_{yy} - I_{zz}}{I_{xx}}qr + \frac{1}{I_{xx}}U_2$
    $\dot{q} = \frac{I_{zz} - I_{xx}}{I_{yy}}pr + \frac{1}{I_{yy}}U_3$
    $\dot{r} = \frac{I_{xx} - I_{yy}}{I_{zz}}pq + \frac{1}{I_{zz}}U_4$

这个包含12个方程的系统，完整地描述了四旋翼在控制输入 $U$ 作用下的动态行为。它是一个高度非线性、强耦合的多输入多输出（MIMO）系统，是设计和仿真各种先进控制算法的基础 [11, 15]。

---

## 5. 模型简化、假设与线性化

任何数学模型都是对物理现实的一种近似。理解模型建立过程中所做的简化和假设，对于评估模型的适用范围和局限性至关重要。

### 5.1. 关键简化假设及其影响的审视

在整个推导过程中，我们依赖了多个关键的简化假设。这些假设并非模型的缺陷，而是为了在保持足够精度的前提下，使模型易于分析和用于控制器设计而做出的必要选择。

1.  **刚体假设 [2, 8]**: 假设四旋翼机身是一个刚体，忽略其在飞行中可能发生的弹性形变。
    *   **影响**: 对于由碳纤维或硬质塑料制成的中小型四旋翼，这是一个非常好的近似。但对于大型、柔性或高速飞行的无人机，机臂的振动可能会影响飞行稳定性，此时刚体模型可能不再适用。

2.  **对称性假设与质心位置 [2]**: 假设飞行器结构完全对称，质心与机体坐标系原点重合。
    *   **影响**: 这使得惯性张量简化为对角矩阵。如果加装了非对称的负载（如相机云台、传感器），质心会发生偏移，惯性积将不再为零，这会引入额外的耦合项，使控制变得更加复杂。

3.  **简化的空气动力学模型 [2, 8]**: 假设推力和反扭矩与旋翼转速的平方成正比，忽略了更复杂的空气动力学效应。
    *   **影响**: 这个模型在悬停和低速飞行时非常有效。但在高速前飞、快速机动或靠近地面/障碍物飞行时，诸如桨叶挥舞、入流变化、地面效应和机身阻力等未建模的动态会变得显著，导致模型预测与实际行为之间产生偏差 [20]。

4.  **忽略机身空气阻力**: 模型中只考虑了旋翼产生的力，忽略了机身在空气中运动时受到的阻力。
    *   **影响**: 在低速时，这种阻力可以忽略不计。但在高速飞行时，机身阻力会成为一个不可忽视的力，影响飞行器的能耗和最高速度。

5.  **理想惯性系 [2]**: 假设地面坐标系是静止的惯性系，忽略地球自转引起的科里奥利力和离心力。
    *   **影响**: 对于绝大多数在局部区域内飞行的四旋翼应用，这种影响微乎其微，完全可以忽略。只有在进行超长距离、高精度导航任务时才需要考虑。

理解这些假设的边界是控制工程师的关键任务。当飞行器的工作状态超出了这些假设的有效范围时，基于简化模型设计的控制器性能就会下降。此时，可能需要引入更复杂的模型，或采用自适应、鲁棒控制等方法来补偿模型的不确定性 [20]。

### 5.2. 悬停平衡点附近的模型线性化

完整的非线性模型对于设计简单的线性控制器（如PID）来说过于复杂。因此，一种常见的做法是在特定的工作点（通常是悬停状态）对模型进行线性化 [21]。

在悬停状态下，飞行器姿态角和所有角速度、线速度都为零或接近于零。即 $\phi \approx 0, \theta \approx 0, p \approx 0, q \approx 0, r \approx 0, \dot{x} \approx 0, \dot{y} \approx 0$。在这种情况下，可以应用小角度近似：$\sin(x) \approx x, \cos(x) \approx 1, \tan(x) \approx x$。

将这些近似代入非线性动力学方程，可以得到一组简化的、近似线性的、解耦的方程组：

*   **高度通道 ($z$)**:
    $\ddot{z} = \frac{1}{m}U_1' - g$ (其中 $U_1'$ 是总推力相对于悬停推力 $mg$ 的增量)

*   **滚转-X位置通道**:
    $\ddot{x} = \frac{U_1}{m}\theta = g\theta$
    $\ddot{\phi} = \frac{L}{I_{xx}}U_2$

*   **俯仰-Y位置通道**:
    $\ddot{y} = -\frac{U_1}{m}\phi = -g\phi$
    $\ddot{\theta} = \frac{L}{I_{yy}}U_3$

*   **偏航通道 ($\psi$)**:
    $\ddot{\psi} = \frac{1}{I_{zz}}U_4$

这个线性化模型揭示了四旋翼控制的核心结构：高度和偏航是两个独立的二阶积分系统。而水平位置（$x, y$）的控制则与姿态（$\phi, \theta$）紧密耦合，形成了一个四阶系统。这正是绝大多数商用和开源飞控采用**内外环串级PID控制**架构的理论基础 [8]：内环快速控制姿态角（$\phi, \theta, \psi$），外环慢速控制位置（$x, y, z$），外环的输出作为内环的期望姿态。

---

## 6. 结论与应用

本报告系统性地完成了从基本物理原理到完整四旋翼六自由度非线性状态空间模型的推导。这个过程始于建立运动学参考框架，通过欧拉角和旋转矩阵描述姿态；接着分析了基于旋翼转速的驱动力学模型；最终应用牛顿-欧拉法建立了描述平动和转动的强耦合、非线性动力学方程。

最终得到的十二维状态空间模型，尽管建立在一系列简化假设之上，但它精确地捕捉了四旋翼飞行的核心动态特性，包括姿态与位置的耦合关系以及欠驱动的本质。它不仅是一个理论分析的工具，更在工程实践中扮演着不可或缺的角色：

1.  **高保真仿真平台**: 该模型是构建飞行仿真器的基础，允许在安全、低成本的虚拟环境中开发、测试和验证新的控制算法、导航策略和故障诊断系统。

2.  **非线性控制器设计**: 它是设计高级非线性控制算法的出发点，例如反馈线性化、反步法（Backstepping）[20]、滑模控制以及模型预测控制（MPC），这些算法能够充分利用模型的非线性特性，实现比传统线性控制器更优越的性能。

3.  **状态估计算法**: 在实际飞行中，并非所有12个状态都能被直接测量。该动力学模型是状态估计算法（如扩展卡尔曼滤波器EKF或无迹卡尔曼滤波器UKF）中的“预测”步骤的核心，用于融合来自IMU、GPS、视觉等多种传感器的数据，以提供对飞行器完整状态的精确估计。

总之，对这一基础模型的深刻理解，是通向四旋翼无人机自主飞行与智能控制领域所有高级研究与应用的必经之路。

---

### **参考文献**